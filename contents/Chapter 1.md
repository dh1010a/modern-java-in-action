# Chapter 1 - 자바 8,9,10,11: 무슨일이 일어나고 있는가?


이 장에서 살펴볼 내용은 크게 아래와 같습니다.
* 자바가 거듭 변화하는 이유
* 컴퓨팅 환경의 변화
* 자바에 부여되는 시대적 변화 요구
* 자바 8과 자바 9의 새로운 핵심 기능 소개

하나씩 내용을 살펴보겠습니다.


## Java8
자바 역사를 통틀어 Java8에서 가장 큰 변화가 일어났습니다. 자바8을 통해 자연어에 더 가깝게 간단한 방식으로 코드를 구현할 수 있게 되었습니다.

멀티코어 CPU 대중화와 같은 하드웨어적인 변화가 일어났지만, 자바8 등장 이전, 멀티 코어의 나머지 코어를 활용하려면 스레드를 사용하는 것이 좋다고 누군가 조언했을 수도 있다고 합니다.

하지만, 스레드를 사용하면 관리하기 어렵고 많은 문제가 발생할 수 있는 단점이 존재합니다. 자바 8은 이러한 병렬 실행 환경을 쉽게 관리하고 에러가 덜 발생하는 방향으로 진화하려 노력했습니다.

자바 8의 새로운 기법을 이용하려면 몇가지 규칙을 지켜야 하며, 그 내용을 이 책에서 설명한다고 합니다.

> 자바 8은 **간결한 코드, 멀티코어 프로세서의 쉬운 활용**이라는 두 가지 요구사항을 기반으로 합니다.

이 두가지 목적성을 가지고 새로 나온 기술 3가지를 요약하자면 아래와 같습니다.

1. 스트림 API
2. 메서드에 코드를 전달하는 기법
3. 인터페이스의 디폴트 메서드

자바8은 데이터베이스 질의 언어에서 표현식을 처리하는 것처럼 **병렬 연산을 지원하는 스트림**이라는 새로운 API를 제공합니다.

- 데이터베이스 질의 언어에서 고수준 언어로 원하는 동작을 표현하면
- 구현(자바에서는 스트림 라이브러리가 이 역할 수행)에서 최적의 저수준 실행 방법을 선택하는 방식으로 동작합니다.
- 즉, 스트림을 이용하면 에러를 자주 일으키며 멀티코어 CPU를 이용하는 것 보다 비용이 훨씬 비싼 키워드 synchronized를 사용하지 않아도 됩니다.


이 스트림 API 덕분에 다른 두 가지 기능, 즉 **메서드에 코드를 전달하는 간결 기법**, 인터페이스의 **디폴트 메서드**가 존재 할 수 있음을 알 수 있습니다.

메서드에 코드를 전달하는 간결 기법(메서드 참조와 람다)을 이용하면 동작 파라미터화를 구현할 수 있습니다.

<br>

⏩ 자바 8은, ```함수형 프로그래밍```에서 위력을 발휘합니다.

## Java8의 변화
프로그래밍 언어는 마치 생태계와 닮았습니다. 새로운 언어가 등장하면서 진화하지 않은 기존 언어는 사장됩니다.

자바는 많은 유용한 라이브러리를 포함하는 잘 설계된 객체지향 언어로 시작했으며, 처음부터 스레드와 락을 이용한 소소한 동시성도 지원했습니다. 

코드를 JVM바이트 코드로 컴파일 하는 특징이 자바를 인터넷 애플릿 프로그램의 주요 언어가 되도록 하였고, JVM의 최신 업데이트 덕분에 경쟁언어는 JVM에서 더 부드럽게 실행될수 있었고 자바와 상호동작 할 수 있게 되었습니다. 또한 자바는 임데디드 컴퓨팅 분야를 성공적으로 장악하고 있습니다.

<br>

>하지만 프로그래밍 언어 생태계에 큰 바람이 불었습니다. 프로그래머는 빅데이터라는 도전에 직면하면서 멀티코어 컴퓨터나 컴퓨팅 클러스터를 이용해서 빅데이터를 효과적으로 처리할 필요성이 커졌습니다.

<br>

### 1. 스트림 처리
스트림이란 한 번에 한 개씩 만들어지는 연속적인 데이터 항목들의 모임입니다.

* 프로그램은 입력 스트림에서 데이터를 한개씩 읽어 들이며 마찬가지로 출력 스트림으로 데이터를 한 개씩 기록한다.
* 즉, 어떤 프로그램의 출력 스트림은 다른 프로그램의 입력 스트림이 될 수 있다.

유닉스의 경우, 파이프 라인을 통해 명령을 연결하여 병렬로 처리할 수 있다. 
```// 파일의 단어를 소문자로 바꾼 다음, 사전순으로 단어를 정렬했을 때 마지막 세 단어 출력
cat file1 file2 | tr "[A-Z]" "[a-z]" | sort | tail -3 
```
cat, tr이 완료되지 않은 시점에서 sort가 행을 처리하기 시작할 수 있다. 기계적인 예로, 여러 자동차 공장은 여러 자동차로 구성된 스트림을 받아 처리하는데, 각각의 작업장에서는 수리 한 뒤 물리적인 순서로 다음 작업장에 넘겨주지만, 각각의 작업장에서는 동시에 작업을 처리합니다.

* 스트림 API는 이처럼 조립 라인처럼 어떤 항목을 연속으로 제공하는 어떤 기능이라고 생각할 수 있으며
* 이 스트림 API는 파이프라인을 만드는 데 필요한 많은 메소드를 제공합니다.

#### 스트림 API의 핵심
1. 기존에 한 번에 한 항목을 처리했지만, 자바8에서는 작업을 고수준으로 추상화해서 일련의 스트림으로 만들어서 처리가 가능합니다.
2. 스트림 파이프라인을 이용해서 입력 부분을 여러 CPU 코어에 쉽게 할당할 수 있습니다.
3. 즉, 스레드라는 복잡한 작업을 사용하지 않으면서도 **공짜로** 병렬성을 얻을 수 있습니다.
   
요약하자면, 기존에 컬렉션 API를 사용할 때는 for루프로 각 요소에 대한 작업을 반복하였고 이는 외부반복 이였으나, 스트림 API는 라이브러리 내부에서 모든 작업을 처리 할 수 있어 루프를 신경쓰지 않아도 되며, 이는 **내부 루프**라고 부릅니다.